<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Bubec ‚ù§Ô∏è</title>
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #FFF9E3;
            background-image: url('beaver_pattern.png');
            background-repeat: repeat;
            background-size: 150px;
            /* Adjust size of pattern */
            font-family: 'Fredoka One', cursive, sans-serif;
            overflow: hidden;
        }

        /* Overlay to ensure text readability over pattern relative to card */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 249, 227, 0.6);
            /* Slight beige tint */
            z-index: 1;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            text-align: center;
            border: 6px solid #ffb3c1;
            width: 85%;
            max-width: 480px;
            position: relative;
            z-index: 5;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 70px rgba(255, 77, 109, 0.25);
        }

        h1 {
            color: #d00000;
            font-size: 2.2rem;
            margin-bottom: 25px;
            line-height: 1.3;
            text-shadow: 2px 2px 0px #fff;
            letter-spacing: 1px;
            min-height: 2.8em;
            /* Reserve space for typewriter */
        }

        .typewriter-cursor::after {
            content: '|';
            animation: blink 1s infinite;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        .button-box {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            height: 140px;
            /* Increased space */
            margin-top: 10px;
            position: relative;
            /* Context for absolute positioning if needed */
        }

        button {
            padding: 15px 35px;
            font-size: 1.5rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Fredoka One', cursive, sans-serif;
            transition: all 0.1s ease-in-out;
            /* Faster transition for snappiness */
            box-shadow: 0 6px 0 rgba(0, 0, 0, 0.1);
        }

        button:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 rgba(0, 0, 0, 0.1);
        }

        #yesBtn {
            background: #ff4d6d;
            color: white;
            z-index: 10;
            border: 2px solid white;
        }

        #noBtn {
            background-color: #ffcccc;
            color: #d00000;
            position: relative;
            /* Starts relative, becomes absolute/fixed */
            z-index: 100;
        }

        #noCounter {
            margin-top: 10px;
            font-size: 1.1rem;
            color: #888;
            font-weight: normal;
            min-height: 1.5em;
        }

        /* VIVID FLASHING ANIMATION */
        .super-active {
            animation: vivid-pulse 0.5s infinite alternate !important;
        }

        @keyframes vivid-pulse {
            0% {
                background-color: #ff4d6d;
                transform: scale(1);
                box-shadow: 0 0 20px #ff4d6d;
            }

            33% {
                background-color: #ff0055;
                transform: scale(1.1);
                box-shadow: 0 0 40px #ff0055;
            }

            66% {
                background-color: #ffcc00;
                color: #d00000;
                transform: scale(1.05);
                box-shadow: 0 0 30px #ffcc00;
            }

            100% {
                background-color: #ff4d6d;
                transform: scale(1);
                box-shadow: 0 0 20px #ff4d6d;
            }
        }

        .bounce-img {
            width: 100%;
            max-width: 280px;
            margin-top: 20px;
            animation: bounce 2s infinite ease-in-out;
            filter: drop-shadow(0 10px 10px rgba(0, 0, 0, 0.1));
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0) rotate(-2deg);
            }

            50% {
                transform: translateY(-15px) rotate(2deg);
            }
        }

        .confetti {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #ff4d6d;
            animation: fall linear forwards;
            z-index: 2;
            /* Below card, above background overlay */
        }

        /* Floating Message Styles */
        .floating-message {
            position: fixed;
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            color: #d00000;
            font-size: 1.1rem;
            pointer-events: none;
            z-index: 150;
            white-space: nowrap;
            animation: floatUpFade 2s forwards ease-out;
            border: 2px solid #ffb3c1;
        }

        .floating-message::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            /* Center the tail */
            transform: translateX(-50%);
            border-width: 8px 8px 0;
            border-style: solid;
            border-color: #ffb3c1 transparent transparent transparent;
        }

        @keyframes floatUpFade {
            0% {
                opacity: 0;
                transform: translateY(10px) scale(0.8);
            }

            20% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

            80% {
                opacity: 1;
                transform: translateY(-30px);
            }

            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }
    </style>
</head>

<body>
    <div class="overlay"></div>

    <div class="card" id="mainCard">
        <h1 id="mainTitle"></h1> <!-- Empty for typewriter -->
        <div class="button-box">
            <button id="yesBtn" onclick="accept()">Yes</button>
            <button id="noBtn" onmouseover="moveNo()" onclick="moveNo()">No</button>
        </div>
        <p id="noCounter"></p> <!-- Counter text -->
    </div>

    <script>
        let yesScale = 1;
        let noClicks = 0;
        const noBtn = document.getElementById('noBtn');
        const yesBtn = document.getElementById('yesBtn');
        const card = document.getElementById('mainCard');
        const titleElement = document.getElementById('mainTitle');
        const counterElement = document.getElementById('noCounter');

        // Typewriter Effect
        const titleText = "Bubec, OFFICIALLY, \nWill you be my Valentine?";
        let charIndex = 0;

        function typeWriter() {
            if (charIndex < titleText.length) {
                const char = titleText.charAt(charIndex);
                titleElement.innerHTML += (char === '\n') ? '<br>' : char;
                charIndex++;
                setTimeout(typeWriter, 75);
            } else {
                titleElement.classList.remove('typewriter-cursor');
            }
        }

        // Start typing on load
        titleElement.classList.add('typewriter-cursor');
        setTimeout(typeWriter, 500);

        const messages = [
            "No, really?",
            "Do you even love?",
            "Click Yes there will be prizez?",
            "Seriously, stop trying to resist...",
            "Don't break my heart! üíî",
            "I'll buy you chocolates!",
            "Pretty please? ü•∫"
        ];

        const counterMessages = [
            "Nice try! üòâ",
            "You're persistent, aren't you? üòè",
            "Okay, now you're just playing with me! üòÇ",
            "I can do this all day... üõ°Ô∏è",
            "Still trying? Really? üßê",
            "Just click YES already! ‚ù§Ô∏è"
        ];

        function moveNo() {
            // Increment counter
            noClicks++;
            updateCounter();

            // Get current positions
            const noRect = noBtn.getBoundingClientRect();

            // Spawn floating message
            createFloatingBalloon(noRect.left + noRect.width / 2, noRect.top);

            // 1. Make Yes Button bigger and SUPER VIVID
            yesScale += 0.4; // Rapid growth as requested
            yesBtn.style.transform = `scale(${yesScale})`;
            yesBtn.classList.add('super-active'); // Flashing vivid colors

            // 2. Localized Movement Logic
            // Switch to fixed if not already
            noBtn.style.position = 'fixed';

            // Movement constraints
            const viewportW = window.innerWidth;
            const viewportH = window.innerHeight;
            const btnW = noBtn.offsetWidth;
            const btnH = noBtn.offsetHeight;
            const padding = 20;

            // Algorithm: Pick a random spot within the centered 80% of the screen.
            const minX = viewportW * 0.1;
            const maxX = viewportW * 0.9 - btnW;
            const minY = viewportH * 0.1;
            const maxY = viewportH * 0.9 - btnH;

            let newX = Math.random() * (maxX - minX) + minX;
            let newY = Math.random() * (maxY - minY) + minY;

            noBtn.style.left = newX + 'px';
            noBtn.style.top = newY + 'px';
        }

        function updateCounter() {
            let msg = "";
            if (noClicks < 5) {
                msg = counterMessages[0];
            } else if (noClicks < 10) {
                msg = counterMessages[1];
            } else if (noClicks < 15) {
                msg = counterMessages[2];
            } else if (noClicks < 20) {
                msg = counterMessages[3];
            } else {
                msg = counterMessages[Math.min(Math.floor((noClicks - 20) / 5) + 4, counterMessages.length - 1)];
            }

            // Just for fun, show the count occasionally
            if (noClicks % 3 === 0) {
                counterElement.innerText = `${msg} (${noClicks} attempts!)`;
            } else {
                counterElement.innerText = msg;
            }

            // Animation for counter
            counterElement.style.animation = 'none';
            counterElement.offsetHeight; /* trigger reflow */
            counterElement.style.animation = 'popIn 0.3s ease-out';
        }

        function createFloatingBalloon(x, y) {
            const msg = messages[Math.floor(Math.random() * messages.length)];
            const balloon = document.createElement('div');
            balloon.classList.add('floating-message');
            balloon.innerText = msg;

            document.body.appendChild(balloon);

            balloon.style.left = (x - balloon.offsetWidth / 2) + 'px';
            balloon.style.top = (y - balloon.offsetHeight - 10) + 'px';

            setTimeout(() => {
                balloon.remove();
            }, 2000);
        }

        function accept() {
            if (noBtn) noBtn.remove();

            // Remove any floating balloons
            document.querySelectorAll('.floating-message').forEach(el => el.remove());

            // Clear counter
            counterElement.style.display = 'none';

            // Celebrate
            const cardEl = document.getElementById('mainCard');
            cardEl.innerHTML = `
                <h1 style="color: #ff4d6d; font-size: 3rem; margin-bottom: 10px;">YAAAY! ‚ù§Ô∏è</h1>
                <p style="font-size: 1.5rem; margin-bottom: 10px; color: #555;">Best decision ever!</p>
                <img src="happy_panda.png" class="bounce-img" alt="Happy Panda">
                <p style="margin-top: 15px; color: #888;">See you on Valentine's Day!</p>
            `;

            triggerConfetti();
        }

        function triggerConfetti() {
            const duration = 3000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function random(min, max) {
                return Math.random() * (max - min) + min;
            }

            const interval = setInterval(function () {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);
                // since particles fall down, start a bit higher than random
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);

            // Also one big blast immediately
            confetti({
                particleCount: 150,
                spread: 100,
                origin: { y: 0.6 }
            });
        }
    </script>
</body>

</html>